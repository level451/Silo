<!DOCTYPE HTML>

<script src="/javascripts/level451web.js"> </script>
<script src="/javascripts/screen.js"> </script>
<script src="/javascripts/ReconnectingWebsocket.js"> </script>

<html>
<head>
    <%=title%>
</head>
<body>
<button onclick="websocket.send('r 3 59 0 0 0 0 0 0 0 0 0\n');">3 ALL</button>
<%var i = 3;%>
<div class="sensorinfo" height="250px">
    <div height="200px">
    <canvas id="Light_<%=i%>" width="75" height="75"></canvas>
    <canvas id="Humidity_<%=i%>" width="75" height="75"></canvas>
    <canvas id="Temp0_<%=i%>" width="75" height="75"></canvas>
    <canvas id="IR_<%=i%>" width="100" height="75"></canvas>
    <canvas id="Contact_<%=i%>" width="100" height="75"></canvas>
    <canvas id="Power_<%=i%>" width="100" height="75"></canvas>
        line
        <br>
        <%var i = 5;%>
        <canvas id="Light_<%=i%>" width="75" height="75"></canvas>
        <canvas id="Humidity_<%=i%>" width="75" height="75"></canvas>
        <canvas id="Temp0_<%=i%>" width="75" height="75"></canvas>
        <canvas id="IR_<%=i%>" width="100" height="75"></canvas>
        <canvas id="Contact_<%=i%>" width="100" height="75"></canvas>
        <canvas id="Power_<%=i%>" width="100" height="75"></canvas>
    </div>

    Sensors
<p class="sensorinfo">Test</p>
</div>

</body>
</html>

<script>
   function drawgauage(id,value){

       if (value > 99){value = value.toFixed(0);}
       if (value > 9 && value < 100){value = value.toFixed(1);}
       if (value < 10 && value > 0){
           console.log("value"+value);
           console.log("id"+id);
           value = value * 1;
          value = value.toFixed(2);
           }
       var canvas = document.getElementById(id);
       //console.log(canvas.width);
       var center = (canvas.width/2);
       var c=canvas.getContext("2d");
       c.strokeStyle="#001010";
       c.lineWidth = center/3;
       c.clearRect(0,0,center*2,center*2);
       c.beginPath();
       c.arc(center,center,center *.7,0,Math.PI,true);
       c.strokeStyle="#a0a0a0";
       c.stroke();
       c.beginPath();
       c.arc(center,center,center *.8,Math.PI,((value/100)*Math.PI)-Math.PI,false);
       c.strokeStyle="red";
       c.stroke();
       c.font = (center/2.5)+"px Arial";
       c.fillText(value,center-(center/2.5),center);
       c.fillText(id.substring(0,id.indexOf("_")),0,center*1.5)
   }

    function msghandler(indata){
        s=JSON.parse(indata);
        if (s.Light_5 != undefined){
            drawgauage("Light_5", (s.Light_5/1024)*100);
        }
        if (s.Humidity_5 != undefined){
            drawgauage("Humidity_5", (s.Humidity_5));
        }
        if (s.Temp0_5 != undefined){
            drawgauage("Temp0_5", (s.Temp0_5));
        }
        if (s.IR_5 != undefined){
            drawgauage("IR_5", (s.IR_5));
        }
        if (s.Contact_5 != undefined){
            drawgauage("Contact_5", (s.Contact_5)*100);
        }
        if (s.Power_5 != undefined){
            drawgauage("Power_5", (s.Power_3)/10);
        }
        if (s.Light_3 != undefined){
            drawgauage("Light_3", (s.Light_3/1024)*100);
        }
        if (s.Humidity_3 != undefined){
            drawgauage("Humidity_3", (s.Humidity_3));
        }
        if (s.Temp0_3 != undefined){
            drawgauage("Temp0_3", (s.Temp0_3));
        }
        if (s.IR_3 != undefined){
            drawgauage("IR_3", (s.IR_3));
        }
        if (s.Contact_3 != undefined){
            drawgauage("Contact_3", (s.Contact_3)*100);
        }
        if (s.Power_3 != undefined){
            drawgauage("Power_3", (s.Power_3)/10);
        }
    }

    function onload(){
      // drawgauage("test",2);
        WebSocketSetup(); // start the websocket
      //  loadscreen(); //init lcd screen canvas
    }

    window.addEventListener("load",onload, false);
</script>
<style>
div.sensorinfo
{
    border-style:solid;
    border-width:1px;
}

</style>